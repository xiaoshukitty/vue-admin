"use strict";(self.webpackChunkvue_test=self.webpackChunkvue_test||[]).push([[7041],{77041:function(e,t,n){n.r(t),n.d(t,{default:function(){return o}});n(57658);var a=n(42325);let i=new(n(25275).AMapManager);var r={data(){const e=this;return{dialogVisible:!1,zoom:15,address:"",center:[114.302444,30.544673],markers:[],searchOption:{city:"",citylimit:!1},amapManager:i,plugin:[{pName:"ToolBar",defaultType:0,events:{}},{pName:"MapType",defaultType:0,events:{}},{pName:"Geolocation",events:{init(t){t.getCurrentPosition(((t,n)=>{if(n&&n.position){e.lng=n.position.lng,e.lat=n.position.lat,e.address=n.formattedAddress,e.center=[e.lng,e.lat];let t=i.getMap();e.marker||(e.marker=new AMap.Marker({position:e.center}),e.marker.setMap(t)),e.marker.setPosition(e.center)}}))}}},{pName:"Driving",events:{init(e){e.search(new AMap.LngLat(114.302444,30.544673),new AMap.LngLat(114.365281,30.519037),(function(e,t){}))}}}],events:{init:e=>{e.getCity((e=>{}))},moveend:()=>{},zoomchange:()=>{},click:t=>{e.lng=t.lnglat.lng,e.lat=t.lnglat.lat,e.center=[e.lng,e.lat];let n=i.getMap();e.marker||(e.marker=new AMap.Marker({position:t.lnglat}),e.marker.setMap(n)),e.marker.setPosition(t.lnglat),new AMap.Geocoder({}).getAddress(t.lnglat,(function(t,n){"complete"===t&&n.regeocode?e.address=n.regeocode.formattedAddress:log.error("根据经纬度查询地址失败")}))}},markers:[{position:[114.302444,30.544673],label:{content:"黄鹤楼",offset:[-75,-30]},icon:"https://img2.baidu.com/it/u=2052441636,3597345036&fm=253&fmt=auto&app=120&f=PNG?w=304&h=304"},{position:[114.365281,30.519037],label:{content:"晴川阁",offset:[-15,-30]},icon:"https://img2.baidu.com/it/u=2052441636,3597345036&fm=253&fmt=auto&app=120&f=PNG?w=304&h=304"}],distance:null}},created(){this.getLongitudeLatitude(),this.markers.push(this.center),this.distance=(0,a.oW)(30.544673,114.302444,30.519037,114.365281).distance.toFixed(2),this.markers[0].label.content=`黄鹤楼距离晴川阁${this.distance}km`},methods:{closeDialog(){this.dialogVisible=!1},onSearchResult(e){if(e.length>0){let{lng:t,lat:n,name:a,location:r}=e[0],o=[t,n];this.lng=t,this.lat=n,this.center=[t,n];let s=i.getMap();this.marker||(this.marker=new AMap.Marker({position:o}),this.marker.setMap(s)),this.marker.setPosition(o);let l=new AMap.Geocoder({}),c=this;l.getAddress(r,(function(e,t){"complete"===e&&t.regeocode&&(c.address=t.regeocode.formattedAddress)}))}},comfirmLngLat(e,t){this.dialogVisible=!1},getLongitudeLatitude(){if("geolocation"in navigator){function e(e){e.coords.latitude,e.coords.longitude}function t(e){}navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}}}},o=(0,n(43736).Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(" 地图")]),n("el-dialog",{attrs:{visible:e.dialogVisible,width:"70%",height:"60%",top:"10vh"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogVisible=t}}},[n("div",{staticClass:"amap-page-container",staticStyle:{width:"100%",height:"550px",margin:"0px"}},[n("el-amap-search-box",{staticClass:"search-box",attrs:{"search-option":e.searchOption,"on-search-result":e.onSearchResult}}),n("el-amap",{ref:"map",staticClass:"amap-demo",attrs:{vid:"amapDemo","amap-manager":e.amapManager,center:e.center,zoom:e.zoom,plugin:e.plugin,events:e.events}},e._l(e.markers,(function(e,t){return n("el-amap-marker",{key:t,attrs:{position:e.position,label:e.label,icon:e.icon}})})),1),n("div",{staticStyle:{display:"flex",position:"relative"}},[n("div",{staticClass:"adress"},[n("p",[e._v(e._s(e.address))]),n("p",[e._v(e._s(e.center))])]),n("div",{staticClass:"confirm",on:{click:function(t){return e.comfirmLngLat(e.center,e.address)}}},[e._v("确定")])])],1)])],1)}),[],!1,null,"2f047d73",null).exports},42325:function(e,t,n){n.d(t,{AM:function(){return d},FR:function(){return l},H7:function(){return p},JM:function(){return i},N2:function(){return s},iw:function(){return a},jE:function(){return c},oW:function(){return r},tK:function(){return u},zi:function(){return o}});n(57658);const a=(e,t)=>{var n=new Image;n.setAttribute("crossOrigin","anonymous"),n.onload=function(){var e=document.createElement("canvas");e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n,0,0,n.width,n.height);var a=e.toDataURL("image/png"),i=document.createElement("a"),r=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});i.download=t||"photo",i.href=a,i.dispatchEvent(r)},n.src=e},i=(e,t)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){if(4===n.readyState&&200===n.status){const e=this.response,n=window.URL.createObjectURL(new Blob([e],{type:"video/mp4"})),a=document.createElement("a");a.download=t,a.href=n,a.style.display="none",document.body.appendChild(a),a.click(),a.remove()}},n.send()},r=(e,t,n,a)=>{function i(e){return e*Math.PI/180}var r=i(e),o=i(n),s=r-o,l=i(t)-i(a),c=2*Math.asin(Math.sqrt(Math.pow(Math.sin(s/2),2)+Math.cos(r)*Math.cos(o)*Math.pow(Math.sin(l/2),2)));c*=6378.137;var u=c=Math.round(1e4*c)/1e4,d="";return d=parseInt(u)>=1?u.toFixed(2)+"km":(1e3*u).toFixed(2)+"m",{distance:u,distance_str:d}},o=(e,t)=>{if(null==e||""==e)return;var n=new Date(Number(e)),a=n.getFullYear(),i=n.getMonth()+1<10?"0"+(n.getMonth()+1):""+(n.getMonth()+1),r=n.getDate()<10?"0"+n.getDate():""+n.getDate(),o=n.getHours(),s=n.getMinutes()<10?"0"+n.getMinutes():""+n.getMinutes(),l=n.getSeconds();return(e=>{let t=new Map([[1,a+"-"+i+"-"+r],[2,a+"-"+i+"-"+r+" "+o+":"+s+":"+l],["default",a+"-"+i+"-"+r+" "+o+":"+s+":"+l]]);return t.get(e)||t.get("default")})(t)},s=(e,t)=>{let n=null;return function(){let a=this,i=arguments;n&&clearTimeout(n),n=setTimeout((()=>{e.apply(a,i)}),t)}},l=e=>{let t=!0;return Object.keys(e).forEach((function(n){null!==e[n]&&void 0!==e[n]||(t=!1)})),t},c=(e,t)=>{for(let n=0;n<e.length;n++){if(e[n].router===t)return e[n].name;if(e[n].children&&e[n].children.length>0){let a=c(e[n].children,t);if(a)return e[n].name+" / "+a}}return null},u=(e,t)=>{var n=!1,a=null;return function e(t,i){for(var r=0;r<t.length;r++)if(t[r].children&&t[r].children.length>0&&e(t[r].children,i),i===t[r].router||n){n||(a=t[r]),n=!0;break}}(e,t),a},d=e=>{let t=[];return e.forEach((e=>{e.children?(t.push(e,...d(e.children)),delete e.children):t.push(e)})),t},p=e=>{const t=e.split("&");let n=new Object;for(var a=0;a<t.length;a++)n[t[a].split("=")[0]]=unescape(t[a].split("=")[1]);return n}}}]);